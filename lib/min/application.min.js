var Converter;!function(a){Converter=function(a){this.conversions=a,this.originType=null,this.originUnit=null},a.extend(Converter.prototype,{getTypes:function(){return"getTypes"},getUnits:function(b){return a.mapValues(this.conversions[b],function(a){return{label:a.name,symbol:a.symbol}})},setOriginUnit:function(a,b){this.originType=a,this.originUnit=b},convertAll:function(){},convert:function(){}})}(window._);var CategoryMenu;!function(a,b){CategoryMenu=function(b){this.el=b,this.$el=a(b),this.init()},b.extend(CategoryMenu.prototype,{init:function(){b.bindAll(this,"_handleCategoryClick");var a=this;a.ui={nav:a.$el.find("nav")},a.ui.nav.find("button").hammer().on({tap:a._handleCategoryClick})},clearActive:function(){this.$el.find(".active").removeClass("active")},setActive:function(b){this.clearActive(),a(b).closest("li").addClass("active")},getActive:function(){return this.ui.nav.find(".active button").text().toLowerCase().replace(/ /g,"-")},_handleCategoryClick:function(a){this.setActive(a.currentTarget),this.$el.trigger("change:active",this.getActive())}})}(jQuery,window._);var ConversionWindow;!function(a,b){ConversionWindow=function(b){this.el=b,this.$el=a(b),this.init()},b.extend(ConversionWindow.prototype,{init:function(){b.bindAll(this,"_handleSwipeLeft");var a=this;a.ui={from:a.$el.find(".convert-from"),to:a.$el.find(".convert-to")},a.ui.from.hammer().on({swipeleft:a._handleSwipeLeft})},getFromValue:function(a){return a?Number(this.ui.from.find(".value").text()):this.ui.from.find(".value").text()},setFromValue:function(a,b){this.ui.from.find(".value").text(a),b||this.triggerChange()},triggerChange:function(){this.$el.trigger("change:fromValue",this.getFromValue())},backspace:function(){this.getFromValue().length>1?this.setFromValue(this.getFromValue().substring(0,this.getFromValue().length-1)):this.$el.trigger("clear:fromValue")},_handleSwipeLeft:function(){return this.backspace(),!1}})}(jQuery,window._);var Calculator;!function(a,b){Calculator=function(b){this.el=b,this.$el=a(b),this.init()},b.extend(Calculator.prototype,{init:function(){b.bindAll(this,"evaluate","_handleDigitClick","_handleFunctionClick","_handleOperatorClick");var a=this;a.$el.find(".digit").hammer().on({tap:a._handleDigitClick}),a.$el.find(".function").hammer().on({tap:a._handleFunctionClick}),a.$el.find(".operator").hammer().on({tap:a._handleOperatorClick}),a.$el.find(".evaluate").hammer().on({tap:a.evaluate})},evaluate:function(){this.$el.trigger("evaluate")},_handleDigitClick:function(b){a(b.currentTarget).hasClass("decimal")?this.$el.trigger("decimal"):this.$el.trigger("digit",Number(a(b.currentTarget).text()))},_handleFunctionClick:function(b){var c=a(b.currentTarget).attr("data-func");switch(c){case"percent":this.$el.trigger("percent");break;case"clear":this.$el.trigger("clear");break;case"inverse":this.$el.trigger("invert");break;default:console.log("No handler set for function: "+c)}},_handleOperatorClick:function(b){this.$el.trigger(a(b.currentTarget).attr("data-operation"))}})}(jQuery,window._);var App;!function(a,b,c,d,e,f,g){App=function(b){this.el=b,this.$el=a(b)},b.extend(App.prototype,{init:function(){b.bindAll(this,"_handleToggleClick","_handleSwipeLeft","_handleSwipeRight","_handleChangeActive","updateConversions","_handlePercent","_handleDigit","_handleDecimal","_handleClear","_handleInvert","_handleAdd","_handleSubtract","_handleDivide","_handleMultiply","_handleEvaluate");var a=this;a.ui={toggle:a.$el.find(".toggle"),menu:a.$el.find(".unit-category"),conversions:a.$el.find(".conversions"),calc:a.$el.find(".calc"),stage:a.$el.find(".stage")},a.converter=new c(g),console.log(a.converter.getTypes()),a.menu=this.getMenu(),a.conversion=this.getConversion(),a.calc=this.getCalc(),a.silentClear=!0,a.silentDigit=!1,a.ui.toggle.hammer().on({tap:a._handleToggleClick}),a.$el.hammer().on({dragleft:a._handleSwipeLeft,dragright:a._handleSwipeRight}),a.menu.$el.bind({"change:active":a._handleChangeActive}),a.conversion.$el.bind({"change:fromValue":a.updateConversions,"clear:fromValue":a._handleClear}),a.calc.$el.bind({digit:a._handleDigit,decimal:a._handleDecimal,percent:a._handlePercent,clear:a._handleClear,invert:a._handleInvert,add:a._handleAdd,subtract:a._handleSubtract,divide:a._handleDivide,multiply:a._handleMultiply,evaluate:a._handleEvaluate})},getConverter:function(){return this.converter},getMenu:function(){return new d(this.ui.menu[0])},getConversion:function(){return new e(this.ui.conversions[0])},getCalc:function(){return new f(this.ui.calc[0])},getSilentClear:function(){return this.silentClear},setSilentClear:function(a){this.silentClear=a},getSilentDigit:function(){return this.silentDigit},setSilentDigit:function(a){this.silentDigit=a},toggleOpen:function(a){b.isUndefined(a)&&(a=!this.isOpen()),this.$el.toggleClass("menu-open",a)},isOpen:function(){return this.$el.hasClass("menu-open")},updateConversions:function(){console.log("Update conversions based on: "+this.conversion.getFromValue(!0))},_operationPrep:function(){this.calc.evaluate(),this.setSilentClear(!0),this.setSilentDigit(!0)},_handleToggleClick:function(){this.toggleOpen()},_handleSwipeLeft:function(){this.toggleOpen(!1)},_handleSwipeRight:function(){this.toggleOpen(!0)},_handleChangeActive:function(a,b){this.toggleOpen(!1),console.log("New active: "+b)},_handleDigit:function(a,b){var c=this.getSilentClear()?b:this.conversion.getFromValue()+b;this.conversion.setFromValue(c,this.getSilentDigit()),this.setSilentClear(!1)},_handleDecimal:function(){b.contains(b.toArray(this.conversion.getFromValue()),".")?this.getSilentClear()&&(this.conversion.setFromValue("0.",this.getSilentDigit()),this.setSilentClear(!1)):this.conversion.setFromValue(this.conversion.getFromValue()+".",this.getSilentDigit())},_handlePercent:function(){this.conversion.setFromValue(this.conversion.getFromValue(!0)/100)},_handleClear:function(){this.calc.evaluate(),this.conversion.setFromValue(0,this.getSilentDigit()),this.setSilentClear(!0),this.setSilentDigit(!1)},_handleInvert:function(){var a=this;this.getSilentClear()?(a.conversion.setFromValue("-",!0),a.setSilentClear(!1)):this.conversion.setFromValue(-1*this.conversion.getFromValue(!0),this.getSilentDigit())},_handleAdd:function(){this._operationPrep();var a=this,b=a.conversion.getFromValue(!0);a.calc.$el.one("evaluate",function(){a.setSilentDigit(!1),a.conversion.setFromValue(b+a.conversion.getFromValue(!0),a.getSilentDigit())})},_handleSubtract:function(){this._operationPrep();var a=this,b=a.conversion.getFromValue(!0);a.calc.$el.one("evaluate",function(){a.setSilentDigit(!1),a.conversion.setFromValue(b-a.conversion.getFromValue(!0),a.getSilentDigit())})},_handleDivide:function(){this._operationPrep();var a=this,b=a.conversion.getFromValue(!0);b=a.conversion.getFromValue(!0),a.calc.$el.one("evaluate",function(){a.setSilentDigit(!1),a.conversion.setFromValue(b/a.conversion.getFromValue(!0),a.getSilentDigit())})},_handleMultiply:function(){this._operationPrep();var a=this,b=a.conversion.getFromValue(!0);a.calc.$el.one("evaluate",function(){a.setSilentDigit(!1),a.conversion.setFromValue(b*a.conversion.getFromValue(!0),a.getSilentDigit())})},_handleEvaluate:function(){this.setSilentClear(!0),this.setSilentDigit(!1)}})}(jQuery,window._,window.Converter,window.CategoryMenu,window.ConversionWindow,window.Calculator,window.Conversions);var app;!function(a){var b=navigator.userAgent,c=b.match(/(iPad|iPhone|iPod)/g)?!0:!1,d=!b.match(/Safari/i)||b.match(/Chrome/i)||b.match(/CriOS/i)?!1:!0;a(document).ready(function(){!window.navigator.standalone&&c?d||a("#install .message").html("You must be using Safari to install <strong>thistothat</strong>"):a("#install").remove(),a("body").bind({touchmove:function(a){a.preventDefault()}}),a("#install").remove(),app=new App(a("body")[0]),app.init()})}(jQuery);