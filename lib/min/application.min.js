var CategoryMenu;(function(e,t){CategoryMenu=function(t){this.el=t;this.$el=e(t);this.init()};t.extend(CategoryMenu.prototype,{init:function(){t.bindAll(this,"_handleCategoryClick");var e=this;e.ui={nav:e.$el.find("nav")};e.ui.nav.find("button").hammer().on({tap:e._handleCategoryClick})},clearActive:function(){this.$el.find(".active").removeClass("active")},setActive:function(t){this.clearActive();e(t).closest("li").addClass("active")},getActive:function(){return this.ui.nav.find(".active button").text().toLowerCase().replace(/ /g,"-")},_handleCategoryClick:function(e){this.setActive(e.currentTarget);this.$el.trigger("change:active",this.getActive())}})})(jQuery,window._);var ConversionWindow;(function(e,t){ConversionWindow=function(t){this.el=t;this.$el=e(t);this.init()};t.extend(ConversionWindow.prototype,{init:function(){var e=this;e.ui={from:e.$el.find(".convert-from"),to:e.$el.find(".convert-to")}},getFromValue:function(e){return e?Number(this.ui.from.find(".value").text()):this.ui.from.find(".value").text()},setFromValue:function(e,t){this.ui.from.find(".value").text(e);t||this.triggerChange()},triggerChange:function(){this.$el.trigger("change:fromValue",this.getFromValue())}})})(jQuery,window._);var Calculator;(function(e,t){Calculator=function(t){this.el=t;this.$el=e(t);this.init()};t.extend(Calculator.prototype,{init:function(){t.bindAll(this,"_handleDigitClick","_handleFunctionClick","_handleOperatorClick","_handleEvaluateClick");var e=this;e.$el.find(".digit").hammer().on({tap:e._handleDigitClick});e.$el.find(".function").hammer().on({tap:e._handleFunctionClick});e.$el.find(".operator").hammer().on({tap:e._handleOperatorClick});e.$el.find(".evaluate").hammer().on({tap:e._handleEvaluateClick})},_handleDigitClick:function(t){e(t.currentTarget).hasClass("decimal")?this.$el.trigger("decimal"):this.$el.trigger("digit",Number(e(t.currentTarget).text()))},_handleFunctionClick:function(t){var n=e(t.currentTarget).attr("data-func");switch(n){case"clear":this.$el.trigger("clear");break;case"inverse":this.$el.trigger("invert");break;default:console.log("No handler set for function: "+n)}},_handleOperatorClick:function(t){this.$el.trigger(e(t.currentTarget).attr("data-operation"))},_handleEvaluateClick:function(){this.$el.trigger("evaluate")}})})(jQuery,window._);var App;(function(e,t,n,r,i){App=function(t){this.el=t;this.$el=e(t)};t.extend(App.prototype,{init:function(){t.bindAll(this,"_handleToggleClick","_handleSwipeLeft","_handleSwipeRight","_handleChangeActive","updateConversions","_handleDigit","_handleDecimal","_handleClear","_handleInvert","_handleAdd","_handleSubtract","_handleDivide","_handleMultiply","_handleEvaluate");var e=this;e.ui={toggle:e.$el.find(".toggle"),menu:e.$el.find(".unit-category"),conversions:e.$el.find(".conversions"),calc:e.$el.find(".calc"),stage:e.$el.find(".stage")};e.menu=this.getMenu();e.conversion=this.getConversion();e.calc=this.getCalc();e.silentClear=!0;e.silentDigit=!1;e.ui.toggle.hammer().on({tap:e._handleToggleClick});e.$el.hammer().on({dragleft:e._handleSwipeLeft,dragright:e._handleSwipeRight});e.menu.$el.bind({"change:active":e._handleChangeActive});e.conversion.$el.bind({"change:fromValue":e.updateConversions});e.calc.$el.bind({digit:e._handleDigit,decimal:e._handleDecimal,clear:e._handleClear,invert:e._handleInvert,add:e._handleAdd,subtract:e._handleSubtract,divide:e._handleDivide,multiply:e._handleMultiply,evaluate:e._handleEvaluate})},getMenu:function(){return new n(this.ui.menu[0])},getConversion:function(){return new r(this.ui.conversions[0])},getCalc:function(){return new i(this.ui.calc[0])},getSilentClear:function(){return this.silentClear},setSilentClear:function(e){this.silentClear=e},getSilentDigit:function(){return this.silentDigit},setSilentDigit:function(e){this.silentDigit=e},toggleOpen:function(e){t.isUndefined(e)&&(e=!this.isOpen());this.$el.toggleClass("menu-open",e)},isOpen:function(){return this.$el.hasClass("menu-open")},updateConversions:function(){console.log("Update conversions based on: "+this.conversion.getFromValue(!0))},_operationPrep:function(){this.calc.$el.trigger("evaluate");this.setSilentClear(!0);this.setSilentDigit(!0)},_handleToggleClick:function(){this.toggleOpen()},_handleSwipeLeft:function(){this.toggleOpen(!1)},_handleSwipeRight:function(){this.toggleOpen(!0)},_handleChangeActive:function(e,t){this.toggleOpen(!1);console.log("New active: "+t)},_handleDigit:function(e,t){var n=this.getSilentClear()?t:this.conversion.getFromValue()+t;this.conversion.setFromValue(n,this.getSilentDigit());this.setSilentClear(!1)},_handleDecimal:function(){this.conversion.getFromValue(!0)===t.parseInt(this.conversion.getFromValue(!0))&&this.conversion.setFromValue(this.conversion.getFromValue()+".",this.getSilentDigit())},_handleClear:function(){this.conversion.setFromValue(0,this.getSilentDigit());this.setSilentClear(!0)},_handleInvert:function(){this.conversion.setFromValue(this.conversion.getFromValue(!0)*-1,this.getSilentDigit())},_handleAdd:function(){this._operationPrep();var e=this,t=e.conversion.getFromValue(!0);e.calc.$el.one("evaluate",function(){e.setSilentDigit(!1);e.conversion.setFromValue(t+e.conversion.getFromValue(!0),e.getSilentDigit())})},_handleSubtract:function(){this._operationPrep();var e=this,t=e.conversion.getFromValue(!0);e.calc.$el.one("evaluate",function(){e.setSilentDigit(!1);e.conversion.setFromValue(t-e.conversion.getFromValue(!0),e.getSilentDigit())})},_handleDivide:function(){this._operationPrep();var e=this,t=e.conversion.getFromValue(!0);t=e.conversion.getFromValue(!0);e.calc.$el.one("evaluate",function(){e.setSilentDigit(!1);e.conversion.setFromValue(t/e.conversion.getFromValue(!0),e.getSilentDigit())})},_handleMultiply:function(){this._operationPrep();var e=this,t=e.conversion.getFromValue(!0);e.calc.$el.one("evaluate",function(){e.setSilentDigit(!1);e.conversion.setFromValue(t*e.conversion.getFromValue(!0),e.getSilentDigit())})},_handleEvaluate:function(){this.setSilentClear(!0)}})})(jQuery,window._,window.CategoryMenu,window.ConversionWindow,window.Calculator);var app;(function(e){var t=navigator.userAgent,n=t.match(/(iPad|iPhone|iPod)/g)?!0:!1,r=t.match(/Safari/i)&&!t.match(/Chrome/i)&&!t.match(/CriOS/i)?!0:!1;e(document).ready(function(){!window.navigator.standalone&&n?r||e("#install .message").html("You must be using Safari to install <strong>thistothat</strong>"):e("#install").remove();e("#install").remove();app=new App(e("body")[0]);app.init()})})(jQuery);